---
/**
 * SEO Head Component
 * Implementing meta tags, Open Graph, Twitter Cards, and Schema.org
 */

export interface Props {
  title?: string;
  description?: string;
  image?: string;
  url?: string;
  type?: 'website' | 'article' | 'profile';
  publishedTime?: string;
  modifiedTime?: string;
  author?: string;
  keywords?: string[];
  noindex?: boolean;
  schema?: object;
}

const {
  title = 'SOLACE Lab | Comfort in Complexity',
  description = 'Health Informatics Research & Innovation Lab. Pioneering precision health, public informatics, and data interoperability in Indonesia.',
  image = '/og-image.png',
  url = Astro.url.href,
  type = 'website',
  publishedTime,
  modifiedTime,
  author,
  keywords = [
    'health informatics',
    'FHIR',
    'HL7',
    'Indonesia',
    'public health',
    'epidemiology',
    'data interoperability',
    'research lab',
  ],
  noindex = false,
  schema,
} = Astro.props;

const siteUrl = 'https://solace.lab';
const fullImageUrl = image.startsWith('http') ? image : `${siteUrl}${image}`;
const canonicalUrl = url.startsWith('http') ? url : `${siteUrl}${url}`;

// Default Organization Schema
const defaultSchema = {
  '@context': 'https://schema.org',
  '@type': 'ResearchOrganization',
  name: 'SOLACE Lab',
  alternateName: 'Solace Health Informatics Research Lab',
  url: siteUrl,
  logo: `${siteUrl}/logo.png`,
  description:
    'Health Informatics Research & Innovation Lab specializing in interoperability, public health systems, and epidemiological analytics.',
  foundingDate: '2022',
  address: {
    '@type': 'PostalAddress',
    addressLocality: 'Yogyakarta',
    addressRegion: 'DIY',
    addressCountry: 'ID',
  },
  contactPoint: {
    '@type': 'ContactPoint',
    email: 'hello@solace.lab',
    contactType: 'General Inquiry',
  },
  sameAs: [
    'https://linkedin.com/company/solace-lab',
    'https://github.com/solace-lab',
  ],
  knowsAbout: [
    'Health Informatics',
    'FHIR',
    'HL7',
    'Public Health',
    'Epidemiology',
    'Data Interoperability',
  ],
};

const schemaData = schema ?? defaultSchema;
---

<!-- Primary Meta Tags -->
<title>{title}</title>
<meta name="title" content={title} />
<meta name="description" content={description} />
<meta name="keywords" content={keywords.join(', ')} />
<meta name="author" content={author ?? 'Solace Research'} />
<meta name="robots" content={noindex ? 'noindex, nofollow' : 'index, follow'} />
<meta name="language" content="English" />
<meta name="revisit-after" content="7 days" />

<!-- Canonical URL -->
<link rel="canonical" href={canonicalUrl} />

<!-- Geo Tags (Local SEO for Indonesia) -->
<meta name="geo.region" content="ID-YO" />
<meta name="geo.placename" content="Yogyakarta" />
<meta name="geo.position" content="-7.797068;110.370529" />
<meta name="ICBM" content="-7.797068, 110.370529" />

<!-- Open Graph / Facebook -->
<meta property="og:type" content={type} />
<meta property="og:url" content={canonicalUrl} />
<meta property="og:title" content={title} />
<meta property="og:description" content={description} />
<meta property="og:image" content={fullImageUrl} />
<meta property="og:image:width" content="1200" />
<meta property="og:image:height" content="630" />
<meta property="og:image:alt" content={title} />
<meta property="og:locale" content="en_US" />
<meta property="og:locale:alternate" content="id_ID" />
<meta property="og:site_name" content="SOLACE Lab" />

{
  publishedTime && (
    <meta property="article:published_time" content={publishedTime} />
  )
}
{
  modifiedTime && (
    <meta property="article:modified_time" content={modifiedTime} />
  )
}
{author && <meta property="article:author" content={author} />}

<!-- Twitter -->
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:url" content={canonicalUrl} />
<meta name="twitter:title" content={title} />
<meta name="twitter:description" content={description} />
<meta name="twitter:image" content={fullImageUrl} />
<meta name="twitter:image:alt" content={title} />

<!-- hreflang for internationalization -->
<link rel="alternate" hreflang="en" href={canonicalUrl} />
<link
  rel="alternate"
  hreflang="id"
  href={canonicalUrl.replace(siteUrl, `${siteUrl}/id`)}
/>
<link rel="alternate" hreflang="x-default" href={canonicalUrl} />

<!-- Schema.org Structured Data -->
<script type="application/ld+json" set:html={JSON.stringify(schemaData)} />

<!-- Preconnect for Performance -->
<link rel="preconnect" href="https://fonts.googleapis.com" />
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<link rel="dns-prefetch" href="https://fonts.googleapis.com" />

<!-- Favicon -->
<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
<link rel="manifest" href="/site.webmanifest" />
<meta name="theme-color" content="#080808" />

<!-- Additional SEO Tags -->
<meta name="format-detection" content="telephone=no" />
<meta name="mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta
  name="apple-mobile-web-app-status-bar-style"
  content="black-translucent"
/>
